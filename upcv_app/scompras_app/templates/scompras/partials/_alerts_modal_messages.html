{% if messages %}
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const messages = [
      {% for message in messages %}
        {
          tag: "{{ message.tags|default:'info'|escapejs }}",
          text: "{{ message|escapejs }}",
        },
      {% endfor %}
    ];
    if (!messages.length || typeof window.showAppModal !== 'function') {
      return;
    }
    const combined = messages.map((item) => `<div>${item.text}</div>`).join('');
    const tag = messages[0].tag || 'info';
    let type = 'info';
    if (tag.includes('success')) type = 'success';
    if (tag.includes('error')) type = 'error';
    if (tag.includes('warning')) type = 'warning';
    if (tag.includes('info')) type = 'info';
    const autoclose = type === 'success';
    window.showAppModal({
      title: type === 'success' ? 'Ã‰xito' : type === 'error' ? 'Error' : 'Aviso',
      message: combined,
      type,
      autoclose,
    });
  });
</script>
{% endif %}
